YUI.add("fluid-overlay-manager-view",function(e){"use strict";var t=0,n=e.Base.create("overlayManager",e.Base,[],{add:function(n){var r=this.get("overlay"),i=n.getAttrs(),s=this;this.get("modals").push(n),r?i.dismissOnOverlayClick&&this.set("dismissOnOverlayClick",!0):(r=e.Node.create(this.get("overlayHTML")),e.one("body").append(r),this.set("overlay",r),t++,this.addOverlayClickHandler(r),this.addOverlayKeyHandler(r),i.dismissOnOverlayClick?this.set("dismissOnOverlayClick",!0):this.set("dismissOnOverlayClick",!1)),this.setOverlayStyle(i),i.dismissOnActionClick&&n.on("actionClick",function(){setTimeout(function(){s.close()},0)}),n.name==="fluid-modal-view"&&n.on("cancelClick",function(){setTimeout(function(){s.close()},0)})},setOverlayStyle:function(e){var t="",n="",r="",i=this.get("overlay");e.hideModalOverlay&&(t="transparent"),e.darkOverlay&&(t="darker-overlay"),e.lightOverlay&&(t="light-overlay"),e.invisibleOverlay&&(n="invisible"),e.overlayClassList&&(r=e.overlayClassList),i.setAttribute("class",this.get("overlayClass")+" "+r+" "+t+" "+n)},addOverlayClickHandler:function(e){e.getDOMNode().addEventListener("click",this.clickHandler.bind(this))},removeOverlayClickHandler:function(e){e.getDOMNode().removeEventListener("click",this.clickHandler.bind(this))},addOverlayKeyHandler:function(t){e.one("body").getDOMNode().addEventListener("keyup",this.keyHandler.bind(this))},removeOverlayKeyHandler:function(t){e.one("body").getDOMNode().removeEventListener("keyup",this.keyHandler.bind(this))},keyHandler:function(e){e.keyCode===27&&this.clickHandler()},clickHandler:function(){var e=this.get("modals").length-2,t="",n="",r="",i,s=this.get("overlay");this.get("dismissOnOverlayClick")&&(this.set("dismissOnOverlayClick",!1),this.close(),e>-1&&this.get("modals").length>0&&(i=this.get("modals")[e].getAttrs(),i.hideModalOverlay&&(t="transparent"),i.invisibleOverlay&&(n="invisible"),i.overlayClassList&&(r=i.overlayClassList),s.setAttribute("class",this.get("overlayClass")+" "+r+" "+t+" "+n),this.set("dismissOnOverlayClick",i.dismissOnOverlayClick)))},remove:function(e){var t=this.get("modals");if(e.isClosed){var n=t.indexOf(e);n>-1?t.splice(n,1):t.length===1&&(n=0,t.splice(n,1)),this.removeOverlay()}},close:function(){var e=this.get("modals").pop();e&&!e.isClosed&&e.close(),this.removeOverlay()},closeAll:function(){var e=this;this.get("modals").forEach(function(t,n){e.close()})},removeOverlay:function(){var e=this.get("overlay");if(this.get("modals").length===0&&e)this.removeOverlayClickHandler(e),this.removeOverlayKeyHandler(e),e.remove(),this.set("overlay",undefined),t--;else{var n=this.get("modals").length-1;n>-1&&this.setOverlayStyle(this.get("modals")[n].getAttrs())}},alreadyShowingModal:function(e){var t=!1;return e||(e="fluid-modal-view"),this.get("modals").forEach(function(n,r){n.name===e&&(t=!0)}),t}},{ATTRS:{modals:{value:[],validator:function(t){return e.Lang.isArray(t)}},overlayHTML:{},overlayClass:{},overlay:{value:undefined},dismissOnOverlayClick:{value:!0,setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},validator:function(t){return e.Lang.isBoolean(t)}}}});e.OverlayManager={DroparoundOverlay:new n({overlayHTML:'<div class="fluid-droparound-overlay"></div>',overlayClass:"fluid-droparound-overlay"}),ModalOverlay:new n({overlayHTML:'<div class="fluid-modal-overlay"><div class="balls"></div></div>',overlayClass:"fluid-modal-overlay"}),SignupInterstitialOverlay:new n({overlayHTML:'<div class="signup-interstitial-overlay interstitial-fade"></div>',overlayClass:"signup-interstitial-overlay interstitial-fade"}),ChalkboardOverlay:new n({overlayHTML:'<div class="fluid-chalkboard-overlay"></div>',overlayClass:"fluid-chalkboard-overlay"}),hasOverlay:function(){return t>0}}},"@VERSION@",{requires:["base","flickr-view","attribute-helpers"],optionalRequires:["fluid"]});
YUI.add("fluid-droparound-view",function(e,t){"use strict";var n=require("hermes-core/flog")(t),r,i,s;r={css:{destinationContainer:"body",subviewContent:".content.subview",menuContent:".content.menu",droparoundContainer:".droparound",droparoundContent:".body .content",droparrow:".droparrow"},options:{}},i={supportsTransform:!1,droparound:{height:0,width:0}},s=function(e,t,n){var r=e.x,i=e.y,s=e.width,o=e.height,u=e.viewportX,a=t.width,f=t.height,l=n.height,c=n.width,h=n.preferredHorizontalOrientation,p=n.preferredVerticalOrientation,d,v,m,g,y,b=a/2,w=f/2,E=i<w,S=r<b;return p==="down"&&(E=!0),p==="up"&&(E=!1),h==="right"&&(S=!0),h==="left"&&(S=!1),n.ignoreBoundary||(l>u&&(E=!0),i+o+l<u&&(E=!1)),E?(g=i+o,y=i+o+l,d={vertical:"down"},S?(v=r,m=r+c,d.horizontal="right"):(v=r-c+s,m=r-s,d.horizontal="left")):(g=i-l,y=i,d={vertical:"up"},S?(v=r,m=r+c,d.horizontal="right"):(v=r-c+s,m=r-s,d.horizontal="left")),{coords:[v,m,g,y],orientation:d}},e.namespace("Views").FluidDroparound=e.FlickrView.create(this.name,e.FlickrView,[],{initializer:function(e){this.set("isActiveViewAgnostic",!0)},buildContainer:function(){return!this.get("textMessage")&&!this.get("htmlMessage")&&!this.get("subview")&&!this.get("menuItems")?(n.warn("requires a `textMessage`, `htmlMessage`, `subview`, or `menuItems`."),this):(this.get("menuItems")&&this.set("menuItems",this.get("menuItems").filter(function(e){return!e.hidden})),this.setContainerWithTemplate("fluid-droparound",{textMessage:this.get("textMessage"),htmlMessage:this.get("message")?this.get("message"):this.get("htmlMessage"),subview:!!this.get("subview"),menuItems:this.get("menuItems"),multiSelect:this.get("multiSelect"),showDropArrow:this.get("showDropArrow"),hideModalOverlay:this.get("hideModalOverlay"),classList:this.get("classList"),footContent:this.get("footContent"),headContent:this.get("headContent"),staticWidth:this.get("width"),staticHeight:this.get("height"),positionFixed:this.get("positionFixed"),autoSizeToContent:this.get("autoSizeToContent"),contentPadding:this.get("contentPadding")}),this.appendAndPosition(),this)},activate:function(){var t=this.get("container"),n=this;e.OverlayManager.DroparoundOverlay.add(this),e.OverlayManager.DroparoundOverlay.setOverlayStyle({overlayClassList:this.get("overlayClassList"),hideModalOverlay:this.get("hideModalOverlay"),invisibleOverlay:this.get("invisibleOverlay")}),this.registerEventHandler(e.on("droparound:reposition",e.bind(this.anchorPositionChange,this))),this.registerEventHandler(e.on("history:change",function(e){if(e.src==="popstate"&&e.prevVal&&e.newVal)if(e.prevVal.flickr&&e.prevVal.flickr.referrer||e.newVal.flickr&&e.newVal.flickr.referrer)return;n.close(e)})),e.use("keyboard-manager",function(e){n.registerEventHandler(t.on("keydown",n.keyboardNavigation,n))});var i=this.get("anchorElement"),s=this.get("keyboardAnchorElement");return s||(s=i.hasAttribute("aria-haspopup")?i:i.ancestor("[aria-haspopup=true]")),s&&(this.set("keyboardAnchorElement",s),this.get("keyboardAnchorElement").setAttribute("aria-expanded","true"),this.registerEventHandler(s.on("key",this.enterDroparound,"down:40",this))),this.get("subview")&&this.loadSubview(),this.get("menuItems")&&this.registerEventHandler(t.one(r.css.menuContent).delegate(["click","keydown"],function(e){(e.type==="click"||e.keyCode===13)&&this.onMenuItemClick(e)}.bind(this),"li")),this.get("observePageResize")&&this.observePageResize(),this.get("closeOnScroll")&&this.observePageScroll(),this.fire("activated"),this},enterDroparound:function(e){var t=this.get("container").one("ul li");t&&(e.preventDefault(),t.focus())},keyboardNavigation:function(e){var t=e.keyCode,n=t===38||t===9&&e.shiftKey,r=t===40||t===9&&!e.shiftKey,i=e.target.ancestor("li",!0);if(this.appContext.getKeyboardManager().inputHasFocus())return;if(n&&i&&i.previous("li"))e.preventDefault(),this.focusOnPreviousItem(e);else if(r)e.preventDefault(),i&&i.next("li")&&this.focusOnNextItem(e);else if(t===27||n){e.preventDefault();var s=this.get("keyboardAnchorElement");s&&(this.close(),s.focus(),s.removeClass("no-outline"))}},focusOnPreviousItem:function(e){var t=e.target.ancestor("li",!0);if(t){var n=t.previous("li");n&&(n.one("a")?n.one("a").focus():n.focus())}},focusOnNextItem:function(e){var t=e.target.ancestor("li",!0);if(t){var n=t.next("li");n&&(n.one("a")?n.one("a").focus():n.focus())}},getDroparoundContainer:function(){return this.get("container")?this.get("container").one(r.css.droparoundContainer):null},loadSubview:function(){var t,n,i=!1,s=this.get("subview"),o=this;t=this.get("container").one(r.css.subviewContent),t.appendChild(e.Node.create(this.templates("flickr-balls")({})).addClass("flickr-balls")),n=setTimeout(function(){i=!0},40),this.loading=!0,s.appContext=o.appContext,s.set("isActiveViewAgnostic",!0),s.initialize().then(function(e){clearTimeout(n),i&&(e.get("container").addClass("load-transition"),setTimeout(function(){e.get("container").removeClass("load-transition")},1)),o.onSubviewInitialized(e)})},onSubviewInitialized:function(t){var n=this,i=this.get("container").one(r.css.subviewContent);if(!this.loading)return;this.loading=!1,i.one(".flickr-balls").remove(!0),i.appendChild(t.get("container")),t.on("subviewViewEvent",function(e){e&&e.details&&e.details.length&&n.fire.apply(n,e.details)}),t.normalizedActivate(),t.recursivelyActivateSubviews(),n.appendAndPosition(),n.registerEventHandler(n.get("subview").on("actionClick",e.bind(n.handleAction,n)))},onMenuItemClick:function(e){var t,n,i;t=e.target.ancestor("li",!0),t&&(n=this.get("container").one(r.css.menuContent).all("li").indexOf(t),n!==-1&&(i=this.get("menuItems")[n],this.get("multiSelect")&&(i.selected=!i.selected,t.toggleClass("selected")),this.fire("selected",{menuItemIndex:n,menuItem:i,origEvent:e})))},appendAndPosition:function(t){var n=e.one(r.css.destinationContainer),s=this.get("container").one(r.css.droparoundContainer);n&&(n.append(this.get("container")),i.droparound.width=this.get("width")||s.getComputedStyle("width"),i.droparound
.height=this.get("height")||s.getComputedStyle("height"),this.repositionToElement(t||this.get("anchorElement")))},updateTextMessage:function(e){e&&e!==""&&(this.set("textMessage",e),this.buildContainer())},updateHTMLMessage:function(e){e&&e!==""&&(this.set("htmlMessage",e),this.buildContainer())},anchorPositionChange:function(){this.repositionToElement(this.get("anchorElement"))},observePageResize:function(){var t=this;this.registerEventHandler(e.globalEvents.subscribe("window:resize",function(n){e.fire("droparound:reposition"),t.get("closeOnResize")&&t.handleClose(n)}))},observePageScroll:function(){var t=YUI.Env.isServer?0:e.config.win.pageYOffset,n=this;this.get("startingScrollPoint")||this.set("startingScrollPoint",t),this.registerEventHandler(e.globalEvents.subscribe("window:scroll",n.handleScroll.bind(n)))},handleScroll:function(t){var n,r=this.get("startingScrollPoint");r?(n=e.config.win.pageYOffset,(r+this.get("closeOnScrollDistance")<n||r-this.get("closeOnScrollDistance")>n)&&this.handleClose(t)):this.set("startingScrollPoint",e.config.win.pageYOffset)},repositionToElement:function(e,t){var n=this.get("container"),i=this.get("positionFixed"),o=n.one(".droparound"),u=this.get("showDropArrow")?o.one(r.css.droparrow):undefined,a=o.one(r.css.droparoundContent),f=a.get("offsetWidth"),l=a.get("offsetHeight"),c,h=u?u.get("offsetHeight"):0,p=e.getXY(),d=p[0],v=p[1],m=e.getDOMNode().getBoundingClientRect(),g={width:o.get("offsetWidth"),height:o.get("offsetHeight")};g.ignoreBoundary=!!t,this.get("preferLeft")&&(g.preferredHorizontalOrientation="left"),this.get("preferRight")&&(g.preferredHorizontalOrientation="right"),this.get("preferTop")&&(g.preferredVerticalOrientation="up"),this.get("preferBottom")&&(g.preferredVerticalOrientation="down");if(!this.anchorCoords||this.x!==0&&this.y!==0)this.anchorCoords={x:i?m.left:d,y:i?m.top:v,width:e.get("offsetWidth"),height:e.get("offsetHeight"),viewportX:e.getDOMNode().getBoundingClientRect().top||0};var y=s(this.anchorCoords,{width:this.appContext.viewportData.getWidth(),height:this.appContext.viewportData.getHeight()},g);y.orientation.vertical==="down"?y.coords[2]+=h-this.get("anchorOffsetVertical"):y.coords[2]-=h+this.get("anchorOffsetVertical"),y.orientation.horizontal==="right"?y.coords[0]-=this.get("anchorOffsetHorizontal"):y.coords[0]+=this.get("anchorOffsetHorizontal"),o.setStyles({left:y.coords[0],top:y.coords[2]}),u&&(u.removeClass("down").removeClass("up").removeClass("left").removeClass("right").addClass(y.orientation.vertical),y.orientation.horizontal==="left"?u.setStyles({right:10+this.get("mirrorArrowAdjustment"),left:"auto"}):u.setStyles({left:10+this.get("mirrorArrowAdjustment")})),!this.get("menuItems")&&!this.get("autoSizeToContent")&&(c={width:f+"px",height:l+"px"},a.setStyles(c))},handleClose:function(e){this.close()},handleAction:function(e){this.fire("actionClick",e),this.get("dismissOnActionClick")&&this.close(e)},show:function(){var e=!this.isActivated,t=this;return this.initialize().then(function(){t.isClosed=!1,e||t.activate()}),this},close:function(){var t=this.get("container");this.loading=!1,this.isClosed=!0;var n=this.get("keyboardAnchorElement");n&&(n.setAttribute("aria-expanded","false"),n.focus(),n.addClass("no-outline")),this.fire("closeDroparound"),this.destroy(),this.get("subview")&&this.get("subview").destroy(),t&&t.remove(!0),e.OverlayManager.DroparoundOverlay.remove(this)},destructor:function(){this.detachAll()},freeze:function(){e.one("body").setStyles({overflow:"hidden"})},unfreeze:function(){e.one("body").setStyles({overflow:"visible"})}},{ATTRS:{dismissOnOverlayClick:{value:!0,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},dismissOnActionClick:{value:!0,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},hideModalOverlay:{value:!0,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},invisibleOverlay:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},preferredSide:{value:null},message:{value:null},textMessage:{value:null},htmlMessage:{value:null},footContent:{value:null},headContent:{value:null},width:{value:0,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},height:{value:0,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},subview:{value:null},menuItems:{value:null},classList:{value:"",validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t,n){return e.AttributeHelpers.coerceString(t)}},anchorElement:{value:null},keyboardAnchorElement:{value:null},showDropArrow:{value:!0,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},anchorOffsetVertical:{value:0,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},anchorOffsetHorizontal:{value:5,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},contentPadding:{value:undefined,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},minVerticalSpace:{value:60,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},minHorizontalSpace:{value:60,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},dropdownArrowWidth:{value:21,validator:function(
t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},dropdownArrowHeight:{value:11},anchorPositionOffset:{value:15,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},observePageResize:{value:!0,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},preferLeft:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},preferRight:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},preferTop:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},preferBottom:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},mirrorArrowAdjustment:{value:0,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},positionFixed:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},closeOnScroll:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},closeOnScrollDistance:{value:40,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},closeOnResize:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},overlayClassList:{value:"",validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t,n){return e.AttributeHelpers.coerceString(t)}},forceLeft:{value:null},forceRight:{value:null},autoSizeToContent:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},horizCenterToAnchor:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},multiSelect:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}}}})},"@VERSION@",{requires:["flickr-view","hermes-template-fluid-droparound","hermes-template-flickr-balls","fluid-overlay-manager-view","attribute-helpers"],optionalRequires:["fluid"]});
YUI.add("hermes-template-notifications",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){return"		<li>\n			"+e.escapeExpression(e.lambda(t,t))+"\n		</li>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression;return'<div class="notifications-container" style="width: '+l((o=(o=n.width||(t!=null?t.width:t))!=null?o:a,typeof o===f?o.call(u,{name:"width",hash:{},data:i}):o))+"; height: "+l((o=(o=n.height||(t!=null?t.height:t))!=null?o:a,typeof o===f?o.call(u,{name:"height",hash:{},data:i}):o))+"; overflow-x: "+l((o=(o=n.overflowX||(t!=null?t.overflowX:t))!=null?o:a,typeof o===f?o.call(u,{name:"overflowX",hash:{},data:i}):o))+"; overflow-y: "+l((o=(o=n.overflowY||(t!=null?t.overflowY:t))!=null?o:a,typeof o===f?o.call(u,{name:"overflowY",hash:{},data:i}):o))+';">\n	<header>\n		<h2>'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"notifications.NOTIFICATIONS"},data:i}))+'</h2>\n		<a href="/mail" class="mail-icon">'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"common.FLICKRMAIL"},data:i}))+' <span class="flickr-mail-count"></span></a>\n	</header>\n	<ul class="notifications-list" style="max-height: '+l((o=(o=n.listHeight||(t!=null?t.listHeight:t))!=null?o:a,typeof o===f?o.call(u,{name:"listHeight",hash:{},data:i}):o))+';">\n		<li class="notifications-empty-state hidden">\n			'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"notifications.NOTIF_NOTHING_HERE"},data:i}))+"\n		</li>\n"+((s=n.each.call(u,t!=null?t.notifications:t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+'	</ul>\n\n	<a href="/activity" class="view-all">'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"notifications.NOTIF_VIEW_RECENT_ACTIVITY"},data:i}))+"</a>\n</div>"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/notifications",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("contact-models",function(e){"use strict";function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{pathAlias:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||undefined},defaultFn:function(e){return e}},username:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},realname:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},displayname:{readOnly:!0,derivedBy:["username","realname"],getter:function(e,t){return this.getValue(t,"realname")||this.getValue(t,"username")}},iconfarm:{},iconserver:{},buddyicon:{readOnly:!0,derivedBy:["iconfarm","iconserver","nsid"],getter:function(t,n){var r=this.getValue(n,"iconfarm"),i=this.getValue(n,"iconserver"),s=this.getValue(n,"nsid");return e.URLHelper.getBuddyIconURL(s,r,i)}},nsid:{readOnly:!0,defaultFn:function(e){return e}},isMe:{readOnly:!0,defaultFn:function(e){var t=this.appContext.getViewer();return t.signedIn&&t.nsid===e}},isPro:{defaultValue:!1,setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},profileURL:{readOnly:!0,derivedBy:["pathAlias","nsid"],defaultFn:function(e){var t=this.getValue(e,"pathAlias");return t||(t=e),"/photos/"+t}},followsURL:{readOnly:!0,derivedBy:["pathAlias","nsid"],defaultFn:function(e){var t=this.getValue(e,"pathAlias");return t||(t=e),"/people/"+t+"/contacts"}}}})},"@VERSION@",{requires:["flickr-model-registry","attribute-helpers","url-helper"]});
YUI.add("flickr-favorites-add-updater",function(e,t){"use strict";function n(n,r){var i={};return i.photo_id=n.photoId,r.callAPI("flickr.favorites.add",i).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-favorites-add"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("flickr-favorites-remove-updater",function(e,t){"use strict";function n(n,r){var i={};return i.photo_id=n.photoId,i.user_id=n.userId,r.callAPI("flickr.favorites.remove",i).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-favorites-remove"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("photo-model-helper",function(e,t){var n=require("hermes-core/flog")(t);e.PhotoModelHelper={updateEngagement:function(t,n){var r=[],i;return e.Lang.isObject(n,!0)&&"isFaved"in n&&(i=n.isFaved.newVal?"flickr-favorites-add":"flickr-favorites-remove",r.push(e.ModelUpdaters[i].run({photoId:t},this.appContext))),e.Promise.all(r)},toggleFave:function(e){var t=this.getValue(e,"faveCount"),n=this.getValue(e,"isFaved"),r=!n,i="photo-engagement-models",s=t+(r?1:-1);this.setValues(e,{isFaved:r,faveCount:s}),this.name!==i&&this.appContext.getModelRegistry(i).then(function(t){t.exists(e)&&t.toggleFave(e)})},addAsFave:function(e){var t=this.getValue(e,"faveCount"),n=this.getValue(e,"isFaved"),r="photo-engagement-models";return n||this.setValues(e,{isFaved:!0,faveCount:t+1}),this.name!==r&&this.appContext.getModelRegistry(r).then(function(t){t.exists(e)&&t.toggleFave(e)}),!n},getLargestSize:function(e,t){return this.getSizeToFit(e,{width:Number.MAX_VALUE,height:Number.MAX_VALUE},t)},getSizeToFit:function(t,r,i){i=i||{};var s=this,o,u=r.width,a=r.height,f=!!i.cropToFit,l=i.includeSquare,c=i.sizes||this.getValue(t,"sizes"),h=i.excludeSizes||["o"],p=i.includeSizes,d,v,m;if(typeof i.includeSizes=="undefined")try{p=Object.keys(c)}catch(g){n.warn("getSizeToFit with invalid sizes",{err:g,sizes:c})}return this._getSizeToFitMemo=this._getSizeToFitMemo||{},o=[t,u,a,f,h.sort().join(""),p.sort().join("")].join("_"),this._getSizeToFitMemo[o]||(e.Object.each(c,function(e,n){var r,i,s,o,c,g;if(e&&h.indexOf(n)===-1&&p.indexOf(n)>-1)if(l||!this.isSizeSquare(n)||this.isPhotoSquare(t)){r=parseInt(e.width,10),i=parseInt(e.height,10),f&&r>=u&&i>=a?s=!0:!f&&(r>=u||i>=a)&&(s=!0),s&&(d?(o=parseInt(d.height,10),i<o&&(d=e)):d=e);if(v){c=parseInt(v.width,10),g=parseInt(v.height,10);if(r>c||i>g)v=e}else v=e}m=d||v},this),this._getSizeToFitMemo[o]=m,this._getSizeToFitMemoTimer||(this._getSizeToFitMemoTimer=setTimeout(function(){delete s._getSizeToFitMemo,delete s._getSizeToFitMemoTimer},1e4))),e.clone(this._getSizeToFitMemo[o],!0)},getSizeIfExact:function(e,t){var n=this.getValue(e,"sizes"),r,i;return Object.keys(n).some(function(e){return e==="o"?!1:(i=n[e],t.height===i.height&&t.width===i.width?(r=i,!0):!1)}),r},isSizeSquare:function(e){var t={sq:"sq",q:"q"};return!!t[e]},isPhotoSquare:function(t){var n;return this._isPhotoSquareMemo=this._isPhotoSquareMemo||{},typeof this._isPhotoSquareMemo[t]!="undefined"?n=this._isPhotoSquareMemo[t]:(n=!0,e.Object.some(this.getValue(t,"sizes"),function(e,t){var r;if(e&&e.width&&e.height&&!this.isSizeSquare(t)){r=parseInt(e.width,10)/parseInt(e.height,10);if(r!==1)return n=!1,!0}},this),this._isPhotoSquareMemo[t]=n),n},getSizeForCanvas:function(e,t,n,r){r=r||1;var i=this.getSizeToFit(e,{width:t*r,height:n*r}),s,o;return s=Math.min(n/r,i.height),o=Math.min(t/r,i.width/i.height*s),s=Math.min(s,i.height/i.width*o),{width:Math.round(o),height:Math.round(s),url:i.url,pixelRatio:i.width/o}},attributes:{title:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},description:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},mediaType:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:"photo"},license:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},isVideo:{readOnly:!0,derivedBy:["mediaType"],getter:function(e,t){var n=this.getValue(t,"mediaType");return n==="video"}},isOwner:{readOnly:!0,derivedBy:["owner"],getter:function(e,t){var n=this.getValue(t,"owner"),r=this.appContext.getViewer();return!!r.signedIn&&n.getValue("id")===r.nsid}},sizes:{},descendingSizes:{readOnly:!0,derivedBy:["sizes"],defaultFn:function(e){var t,n,r=[];this._descendingSizesMemo=this._descendingSizesMemo||{};if(this._descendingSizesMemo[e])return this._descendingSizesMemo[e];t=this.getValue(e,"sizes");for(n in t)r.push(t[n]),r[r.length-1].key=n;return r.sort(function(e,t){return e.width<t.width?1:e.width===t.width?e.height<t.height?1:e.height===t.height?e.key==="o"?-1:1:-1:-1}),this._descendingSizesMemo[e]=r,r}},ascendingSizes:{readOnly:!0,derivedBy:["descendingSizes"],defaultFn:function(e){return this.getValue(e,"descendingSizes").reverse()}},aspectRatio:{readOnly:!0,derivedBy:["descendingSizes","rotation"],defaultFn:function(e){var t=this.getValue(e,"descendingSizes")[0];return t.key==="o"&&this.getValue(e,"rotation")%180!==0?t.height/t.width:t.width/t.height}},needsInterstitial:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},canComment:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!0},canPublicComment:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},url:{readOnly:!0,derivedBy:["owner"],defaultFn:function(e){var t=this.getValue(e,"owner");return t?"/photos/"+t.getValue("pathAlias")+"/"+e:undefined}},rotation:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},ownerNsid:{},isFaved:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},faveCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},commentCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},canFave:{readOnly
:!0,derivedBy:["is_owner"],getter:function(e,t){return!this.getValue(t,"isOwner")}},basicSimilaritySearchURL:{readOnly:!0,getter:function(e,t){return"/search/?similarity_id="+t}},similaritySearchURL:{readOnly:!0,derivedBy:["basicSimilaritySearchURL"],getter:function(e,t){var n=this.getValue(t,"basicSimilaritySearchURL");return this.appContext.flipper.isFlipped("enable-similarity-search-safety")&&(n+="&safe_search=1"),n}}}}},"@VERSION@",{requires:["flickr-favorites-add-updater","flickr-favorites-remove-updater"]});
YUI.add("flickr-photos-geo-setLocation-updater",function(e,t){"use strict";e.namespace("ModelUpdaters")["flickr-photos-geo-setLocation"]={run:function(n,r){return r.callAPI("flickr.photos.geo.setLocation",n).then(null,e.FetcherErrorLogger(t))}}},"@VERSION@");
YUI.add("photo-geo-models",function(e){function r(e){r.superclass.constructor.call(this,e)}var t=1,n=16;e.Models[this.name]=r,e.extend(r,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext).then(function(e){return e},function(){})},update:function(t,n){var r={photo_id:t,lat:this.getValue(t,"latitude"),lon:this.getValue(t,"longitude")};n.hasOwnProperty("accuracy")&&(r.accuracy=this.getValue(t,"accuracy"));if(n.hasOwnProperty("isPublic")||n.hasOwnProperty("isContact")||n.hasOwnProperty("isFriend")||n.hasOwnProperty("isFamily"))r.is_public=Number(this.getValue(t,"isPublic")),r.is_contact=Number(this.getValue(t,"isContact")),r.is_friend=Number(this.getValue(t,"isFriend")),r.is_family=Number(this.getValue(t,"isFamily"));return e.ModelUpdaters["flickr-photos-geo-setLocation"].run(r,this.appContext)}},attributes:{hasGeo:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},latitude:{validator:function(t,n){return e.AttributeHelpers.validateFloat(t)},setter:function(t){return e.AttributeHelpers.coerceFloat(t)||undefined},defaultValue:undefined},longitude:{validator:function(t,n){return e.AttributeHelpers.validateFloat(t)},setter:function(t){return e.AttributeHelpers.coerceFloat(t)||undefined},defaultValue:undefined},accuracy:{validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(r){return e.AttributeHelpers.coerceInteger(Math.max(t,Math.min(r,n)))||undefined},defaultValue:t},isPublic:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-getInfo-fetcher","attribute-helpers","flickr-photos-geo-setLocation-updater"]});
YUI.add("photo-location-models",function(e){function t(e){t.superclass.constructor.call(this,e)}t.SUPPORTED_WOE_LEVELS=["neighbourhood","locality","county","region","country","continent"],e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext).then(function(e){return e},function(){})}},attributes:{geo:{isModel:!0},hasGeo:{readOnly:!0,derivedBy:["geo"],defaultFn:function(e){var t=this.getValue(e,"geo");return t?t.getValue("hasGeo"):!1}},latitude:{readOnly:!0,derivedBy:["geo"],defaultFn:function(e){var t=this.getValue(e,"geo");return t?t.getValue("latitude"):null}},longitude:{readOnly:!0,derivedBy:["geo"],defaultFn:function(e){var t=this.getValue(e,"geo");return t?t.getValue("longitude"):null}},levels:{},text:{},mostSpecificWoeId:{readOnly:!0,derivedBy:["levels"],defaultFn:function(e){var n=this.getValue(e,"levels"),r;return t.SUPPORTED_WOE_LEVELS.some(function(e){if(n[e]&&n[e].woeId)return r=n[e].woeId,!0}),r}},mostSpecificLevelIndex:{readOnly:!0,derivedBy:["levels"],defaultFn:function(e){var n=this.getValue(e,"levels"),r;return t.SUPPORTED_WOE_LEVELS.some(function(e,t){if(n[e]&&n[e].woeId)return r=t,!0}),r}},staticMaps:{}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photos-getInfo-fetcher","attribute-helpers"]});
YUI.add("flickr-photos-getLocation-fetcher",function(e,t){"use strict";function n(t,n){var i=t.photo||{},s=i.location||null,o,u=i.staticMaps&&i.staticMaps.staticMap||null,a=i.venues?i.venues.venue:null,f,l=[];return f={id:i.id,levels:{}},s?(o={id:i.id,hasGeo:!0,latitude:s.latitude,longitude:s.longitude,accuracy:s.accuracy},e.Models["photo-location-models"].SUPPORTED_WOE_LEVELS.forEach(function(e){if(!s[e])return;f.levels[e]={name:s[e].content||null,woeId:s[e].woeid||null}}),i.geoperms&&(o.isPublic=i.geoperms.ispublic,o.isContact=i.geoperms.iscontact,o.isFriend=i.geoperms.isfriend,o.isFamily=i.geoperms.isfamily)):o={id:i.id,hasGeo:!1},f.geo=n.addOrUpdate(o),a&&(f.levels.venue={name:a.content||a.address||null,woeId:a.woe_id,source:a.source,venueId:a.id,venueLat:a.latitude,venueLong:a.longitude},a.content&&l.push(a.content),a.city&&l.push(a.city),a.country&&l.push(a.country),f.text=l.join(", ")),f.text||(f.text=r(f.levels)),e.Lang.isArray(u)&&(f.staticMaps={},u.forEach(function(e){f.staticMaps["zoom"+e.zoom]=e})),f}function r(e){var t=[],n,r,i;n=[["venue","locality","region"],["neighbourhood","locality","region"],["locality","region","country"],["county","region","country"]];while(n.length&&t.length<3){r=n.shift(),t=[];while(r.length&&t.length<3)i=r.shift(),e[i]&&e[i].name&&t.push(e[i].name)}return t.join(", ")}function i(n,r){var i=n.id,s={photo_id:i,extras:"venue"},o=this;return e.APIHelper.request.addStaticMapsParams(s),e.Promise.all([r.callAPI("flickr.photos.geo.getLocation",s),r.getModelRegistry("photo-location-models"),r.getModelRegistry("photo-geo-models")]).then(function(e){var t=e[0],n=e[1],r=e[2],i=o.mapResponse(t,r);return n.addOrUpdate(i),i},e.FetcherErrorLogger(t))}e.namespace("ModelFetchers")["flickr-photos-getLocation"]={run:i,mapResponse:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-geo-models","photo-location-models"]});
YUI.add("flickr-contacts-add-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.contacts.add",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-contacts-add"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-contacts-remove-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.contacts.remove",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-contacts-remove"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-contacts-edit-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.contacts.edit",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-contacts-edit"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-contacts-block-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.contacts.block",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-contacts-block"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-contacts-unblock-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.contacts.unblock",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-contacts-unblock"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("person-relationship-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},update:function(t,n){var r=[],i={};if(e.Lang.isObject(n,!0)){i.user_id=t,i.friend=this.getValue(t,"isFriend"),i.family=this.getValue(t,"isFamily"),"isContact"in n&&(n.isContact.newVal?r.push(e.ModelUpdaters["flickr-contacts-add"].run(i,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-remove"].run(i,this.appContext)));if("isFriend"in n||"isFamily"in n)"isFriend"in n&&(i.friend=n.isFriend.newVal),"isFamily"in n&&(i.family=n.isFamily.newVal),r.push(e.ModelUpdaters["flickr-contacts-edit"].run(i,this.appContext));"isIgnored"in n&&(n.isIgnored.newVal===!0?r.push(e.ModelUpdaters["flickr-contacts-block"].run(i,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-unblock"].run(i,this.appContext)))}return e.Promise.all(r)}},toggleFollowing:function(e){var t=this.getValue(e,"isContact");t?this.setValue(e,"isContact",!1):this.setValue(e,"isContact",!0)},toggleFriend:function(e){var t=this.getValue(e,"isFriend");t?this.setValue(e,"isFriend",!1):this.setValue(e,"isFriend",!0)},toggleFamily:function(e){var t=this.getValue(e,"isFamily");t?this.setValue(e,"isFamily",!1):this.setValue(e,"isFamily",!0)},toggleIgnore:function(e){var t=this.getValue(e,"isIgnored");t?this.setValue(e,"isIgnored",!1):this.setValue(e,"isIgnored",!0)},attributes:{pathAlias:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},isContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnoredBy:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnored:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isMe:{readOnly:!0,getter:function(e,t){var n=this.appContext.getViewer();return!!n&&this.getValue(t,"nsid")===n.nsid}},nsid:{readOnly:!0,defaultFn:function(e){return e}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","flickr-contacts-add-updater","flickr-contacts-remove-updater","flickr-contacts-edit-updater","flickr-contacts-block-updater","flickr-contacts-unblock-updater","attribute-helpers"]});
YUI.add("flickr-prefs-setSafeSearch-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.prefs.setSafeSearch",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-prefs-setSafeSearch"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("person-preferences-models",function(e){function t(e){t.superclass.constructor.call(this,e)}t.UNIFIED_SEARCH_VIEW_TYPES={justified:"jst",thumbs:"thm",tiles:"til"},t.UNIFIED_SEARCH_VIEW_TYPE_DEFAULT=t.UNIFIED_SEARCH_VIEW_TYPES.justified,t.PHOTOSTREAM_VIEW_ORDER_TYPES={dateposted:"dc",datetaken:"dt"},t.PHOTOSTREAM_VIEW_ORDER_DEFAULT=t.PHOTOSTREAM_VIEW_ORDER_TYPES.dateposted,t.PHOTOSTREAM_VIEW_AS_TYPES={me:"me",friend:"fr",family:"fa",ff:"ff","public":"pu"},t.PHOTOSTREAM_VIEW_PREF_MAP={me:"me",fr:"friend",fa:"family",ff:"ff",pu:"public",dc:"dateposted",dt:"datetaken"},t.ALBUM_VIEW_LAYOUT_TYPES={justified:"justified",story:"story"},t.ALBUM_VIEW_LAYOUT_DEFAULT=t.ALBUM_VIEW_LAYOUT_TYPES.story,t.PHOTOSTREAM_VIEW_AS_DEFAULT=t.PHOTOSTREAM_VIEW_AS_TYPES.public,e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},update:function(t,n){var r=[],i={};return e.Lang.isObject(n,!0)&&("safeSearch"in n?(i.safe_search=e.AttributeHelpers.coerceInteger(n.safeSearch.newVal)+1,r.push(e.ModelUpdaters["flickr-prefs-setSafeSearch"].run(i,this.appContext))):"photostreamViewOrderPref"in n||"photostreamViewAsPref"in n?(n.photostreamViewOrderPref&&(i.photostream_view_order_pref=n.photostreamViewOrderPref.newVal),n.photostreamViewAsPref&&(i.photostream_view_as_pref=n.photostreamViewAsPref.newVal),r.push(this.appContext.callAPI("flickr.prefs.setPrefs",i))):"albumViewLayoutPref"in n?(n.albumViewLayoutPref&&(i.album_view_layout=n.albumViewLayoutPref.newVal),r.push(this.appContext.callAPI("flickr.prefs.setPrefs",i))):Object.keys(n).forEach(function(e){e==="unifiedSearchViewPref"?i.unified_search_view_pref=n.unifiedSearchViewPref.newVal:i[e]=n[e],r.push(this.appContext.callAPI("flickr.prefs.setPrefs",i))})),e.Promise.all(r)},readUserPrefs:function(e,t){return t.callAPI("flickr.feed.preferences.getUserPreferences",e,t).then(function(e){return e},function(e){})}},remoteReadUserPrefs:function(e,t,n){return this.remote.readUserPrefs(t,n).then(function(e){return e},function(e){})},attributes:{safeSearch:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},unifiedSearchViewPref:{validator:function(n){return e.AttributeHelpers.validateString(n)?Object.keys(t.UNIFIED_SEARCH_VIEW_TYPES).some(function(e){return t.UNIFIED_SEARCH_VIEW_TYPES[e]===n}):!1},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:t.UNIFIED_SEARCH_VIEW_TYPE_DEFAULT},photostreamViewOrderPref:{validator:function(n){return e.AttributeHelpers.validateString(n)?Object.keys(t.PHOTOSTREAM_VIEW_ORDER_TYPES).some(function(e){return t.PHOTOSTREAM_VIEW_ORDER_TYPES[e]===n}):!1},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:t.PHOTOSTREAM_VIEW_ORDER_DEFAULT},photostreamViewAsPref:{validator:function(n){return e.AttributeHelpers.validateString(n)?Object.keys(t.PHOTOSTREAM_VIEW_AS_TYPES).some(function(e){return t.PHOTOSTREAM_VIEW_AS_TYPES[e]===n}):!1},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:t.PHOTOSTREAM_VIEW_AS_DEFAULT},albumViewLayoutPref:{validator:function(n){return e.AttributeHelpers.validateString(n)?Object.keys(t.ALBUM_VIEW_LAYOUT_TYPES).some(function(e){return t.ALBUM_VIEW_LAYOUT_TYPES[e]===n}):!1},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:t.ALBUM_VIEW_LAYOUT_DEFAULT}}},{getReadablePrefName:function(e){return t.PHOTOSTREAM_VIEW_PREF_MAP[e]},buildContextSuffix:function(t,n){var r=e.Models["person-preferences-models"].getReadablePrefName(t.getValue("photostreamViewOrderPref")),i=e.Models["person-preferences-models"].getReadablePrefName(t.getValue("photostreamViewAsPref"));return i===e.Models["person-preferences-models"].PHOTOSTREAM_VIEW_PREF_MAP.me||t.id!==n?r:r+"-"+i}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","flickr-prefs-setSafeSearch-updater","attribute-helpers"]});
YUI.add("person-profile-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)}},attributes:{nsid:{readOnly:!0,defaultFn:function(e){return e}},photoCount:{},unreadMessages:{},storageUsed:{},storageTotal:{},coverPhotoUrls:{},location:{}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher"]});
YUI.add("flickr-groups-join-creator",function(e,t){"use strict";function n(n,r){var i={};return i.group_id=n.groupModel.id,i.accept_rules=n.acceptRules,e.Promise.all([r.callAPI("flickr.groups.join",i)]).then(function(e){var t=e[0];if(t.stat==="ok")return n.groupModel.join(),n.groupModel},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-groups-join"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("flickr-groups-leave-deletor",function(e,t){"use strict";function n(n,r){var i={};return i.group_id=n.groupModel.id,i.delete_photos=n.deletePhotos,e.Promise.all([r.callAPI("flickr.groups.leave",i)]).then(function(e){var t=e[0];if(t.stat==="ok")return n.groupModel.leave(),n.groupModel},e.FetcherErrorLogger(t))}e.namespace("ModelDeletors")["flickr-groups-leave"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("group-info-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-groups-getInfo"].run(t,this.appContext)},join:function(t,n){return e.ModelCreators["flickr-groups-join"].run(t,n)},leave:function(t,n){return e.ModelDeletors["flickr-groups-leave"].run(t,n)}},join:function(e){var t=this.getValue(e,"group");return t&&t.setValue("isMember",!0),this},leave:function(e){var t=this.getValue(e,"group");return t&&(t.setValue("isAdmin",!1),t.setValue("isModerator",!1),t.setValue("isMember",!1),this.setValue(e,"hasPendingRequestToJoin",!1)),this},attributes:{pathAlias:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},description:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},secureDescription:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},rules:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},roles:{},secureRules:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},hasPendingRequestToJoin:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isInvited:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},discussionsLocked:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},privacy:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:1},restrictions:{},throttle:{},poolPreviewRowsVisibleCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return 1}},coverPhotoAttribution:{},group:{isModel:!0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-groups-getInfo-fetcher","flickr-groups-join-creator","flickr-groups-leave-deletor","attribute-helpers","group-models"]});
